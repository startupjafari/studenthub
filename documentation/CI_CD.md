# CI/CD —Å GitHub Actions

## üìã –û–±–∑–æ—Ä

–í –ø—Ä–æ–µ–∫—Ç–µ StudentHub –Ω–∞—Å—Ç—Ä–æ–µ–Ω CI/CD —á–µ—Ä–µ–∑ GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

---

## üîÑ Workflow —Ñ–∞–π–ª—ã

### 1. `ci.yml` - –û—Å–Ω–æ–≤–Ω–æ–π CI workflow

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- Push –≤ –≤–µ—Ç–∫–∏ `main` –∏ `develop`
- Pull Request –≤ –≤–µ—Ç–∫–∏ `main` –∏ `develop`

**Jobs:**

#### `lint` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–∏–Ω–≥–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ ESLint
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Prettier

#### `build` - –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client
- –°–±–æ—Ä–∫–∞ TypeScript –ø—Ä–æ–µ–∫—Ç–∞

#### `test` - –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL –∏ Redis —Å–µ—Ä–≤–∏—Å–æ–≤
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
- –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
- –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç—á–µ—Ç–æ–≤ –æ –ø–æ–∫—Ä—ã—Ç–∏–∏ –≤ Codecov

#### `security` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ê—É–¥–∏—Ç npm –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

#### `type-check` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ TypeScript
- –ö–æ–º–ø–∏–ª—è—Ü–∏—è TypeScript –±–µ–∑ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤

---

### 2. `deploy.yml` - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- Push –≤ –≤–µ—Ç–∫—É `main` ‚Üí –¥–µ–ø–ª–æ–π –≤ staging
- Push —Ç–µ–≥–∞ `v*` ‚Üí –¥–µ–ø–ª–æ–π –≤ production

**Jobs:**

#### `deploy-staging`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ `main`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç environment `staging`

#### `deploy-production`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–µ–≥–∞ –≤–µ—Ä—Å–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç environment `production`
- –°–æ–∑–¥–∞–µ—Ç GitHub Release

**‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ö–æ–º–∞–Ω–¥—ã –¥–µ–ø–ª–æ—è –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥ –≤–∞—à—É –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É.

---

### 3. `pr-check.yml` - –ü—Ä–æ–≤–µ—Ä–∫–∞ Pull Request

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- –û—Ç–∫—Ä—ã—Ç–∏–µ Pull Request
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Pull Request

**–ü—Ä–æ–≤–µ—Ä–∫–∏:**
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `console.log` –≤ –Ω–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ TODO/FIXME –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ commit —Å–æ–æ–±—â–µ–Ω–∏–π (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω commitlint)

---

### 4. `dependabot-auto-merge.yml` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ª–∏—è–Ω–∏–µ Dependabot PR

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- Pull Request –æ—Ç Dependabot

**–î–µ–π—Å—Ç–≤–∏—è:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–∏–Ω–≥–∞ –∏ —Å–±–æ—Ä–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ª–∏—è–Ω–∏–µ, –µ—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–ª—è —Ä–∞–±–æ—Ç—ã workflow –º–æ–≥—É—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —Å–µ–∫—Ä–µ—Ç—ã GitHub:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Settings ‚Üí Secrets and variables ‚Üí Actions
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã:
   - `DATABASE_URL` (–¥–ª—è —Ç–µ—Å—Ç–æ–≤)
   - `JWT_SECRET`
   - `JWT_REFRESH_SECRET`
   - –ò –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### Environments

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ environments –≤ GitHub:

1. Settings ‚Üí Environments
2. –°–æ–∑–¥–∞–π—Ç–µ `staging` –∏ `production`
3. –î–æ–±–∞–≤—å—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ environment

### Codecov (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç—á–µ—Ç–æ–≤ –æ –ø–æ–∫—Ä—ã—Ç–∏–∏:

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [codecov.io](https://codecov.io)
2. –î–æ–±–∞–≤—å—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω
4. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç `CODECOV_TOKEN` –≤ GitHub

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ CI –≤—Ä—É—á–Ω—É—é

CI –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏:
- Push –≤ `main` –∏–ª–∏ `develop`
- –°–æ–∑–¥–∞–Ω–∏–∏ Pull Request

### –î–µ–ø–ª–æ–π

#### Staging
```bash
# –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—à—å—Ç–µ –≤ main
git push origin main
```

#### Production
```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ–≥ –≤–µ—Ä—Å–∏–∏
git tag v1.0.0
git push origin v1.0.0
```

---

## üìä –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–æ–∫

–°—Ç–∞—Ç—É—Å CI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:
- –í Pull Request
- –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Actions –≤ GitHub
- –í README (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å badges)

### Badges –¥–ª—è README

```markdown
![CI](https://github.com/your-username/studenthub/workflows/CI/badge.svg)
![Deploy](https://github.com/your-username/studenthub/workflows/Deploy/badge.svg)
```

---

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Actions –≤–∫–ª–∞–¥–∫—É GitHub
2. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π workflow run
3. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ job

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

GitHub –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
- –ü—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ CI
- –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –¥–µ–ø–ª–æ–µ
- –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö

---

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–µ–ø–ª–æ—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: SSH –¥–µ–ø–ª–æ–π

```yaml
- name: Deploy via SSH
  uses: appleboy/ssh-action@master
  with:
    host: ${{ secrets.SSH_HOST }}
    username: ${{ secrets.SSH_USER }}
    key: ${{ secrets.SSH_KEY }}
    script: |
      cd /var/www/studenthub
      git pull
      npm ci
      npm run build
      pm2 restart studenthub-backend
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Docker –¥–µ–ø–ª–æ–π

```yaml
- name: Build and push Docker image
  uses: docker/build-push-action@v4
  with:
    context: ./studenthub-backend
    push: true
    tags: your-registry/studenthub-backend:${{ github.ref_name }}
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: Cloud –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

- **Vercel:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π action
- **AWS:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ AWS CLI –∏–ª–∏ SDK
- **Heroku:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Heroku CLI

---

## üìã Dependabot

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ —á–µ—Ä–µ–∑ `.github/dependabot.yml`:

- **NPM –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –ø–æ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞–º
- **GitHub Actions:** –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ
- **Docker:** –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

Dependabot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç PR –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π. PR –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ—Ä–∂–∞—Ç—Å—è, –µ—Å–ª–∏:
- –ü—Ä–æ—Ö–æ–¥—è—Ç –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ CI
- –≠—Ç–æ –º–∏–Ω–æ—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (patch –∏ minor)

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- [x] –°–æ–∑–¥–∞–Ω `.github/workflows/ci.yml`
- [x] –°–æ–∑–¥–∞–Ω `.github/workflows/deploy.yml`
- [x] –°–æ–∑–¥–∞–Ω `.github/workflows/pr-check.yml`
- [x] –°–æ–∑–¥–∞–Ω `.github/dependabot.yml`
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã GitHub Secrets
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã Environments (staging, production)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–æ–º–∞–Ω–¥—ã –¥–µ–ø–ª–æ—è –≤ `deploy.yml`
- [ ] –î–æ–±–∞–≤–ª–µ–Ω Codecov —Ç–æ–∫–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω workflow –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º PR

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [Dependabot Documentation](https://docs.github.com/en/code-security/dependabot)
- [Codecov Documentation](https://docs.codecov.com/)

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ workflow –∏—Å–ø–æ–ª—å–∑—É—é—Ç Node.js 18.x
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ `node_modules` –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–µ—Ä–≤–∏—Å—ã PostgreSQL –∏ Redis –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ª–∏—è–Ω–∏–µ Dependabot PR —Ç–æ–ª—å–∫–æ –¥–ª—è –º–∏–Ω–æ—Ä–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-15
